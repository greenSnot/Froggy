import React from 'react';
import {createRoot} from 'react-dom/client';

import { Brick, Workspace } from 'froggy';

import { atomic_button_fns, atomic_dropdown_menu, toolbox } from './toolbox';

import './styles/index.less';

const storage_key = 'root_bricks';
const save = (bricks: Brick[]) => {
  localStorage.setItem(storage_key, JSON.stringify(bricks));
};
const load = () => JSON.parse(localStorage.getItem(storage_key) || '[]');
save(JSON.parse("[{\"type\":\"data_variable_set\",\"next\":{\"type\":\"data_variable_set\",\"next\":null,\"is_root\":false,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"set variable\",\"parent\":\"0.nkdm3qdc4bc\",\"delegate\":\"0.nkdm3qdc4bc\",\"is_ghost\":false},\"root\":\"0.clmraaqp32\",\"id\":\"0.m1pltgti3rs\"},{\"type\":\"container\",\"is_static\":true,\"output\":1,\"inputs\":[{\"type\":\"atomic_input_string\",\"output\":1,\"is_static\":true,\"ui\":{\"value\":\"x\",\"parent\":\"0.vvhrqg44c08\",\"is_ghost\":false},\"root\":\"0.clmraaqp32\",\"id\":\"0.ti2chl54qa4\"}],\"root\":\"0.clmraaqp32\",\"id\":\"0.vvhrqg44c08\",\"ui\":{\"parent\":\"0.nkdm3qdc4bc\",\"is_ghost\":false}},{\"type\":\"atomic_text\",\"ui\":{\"value\":\"to\",\"parent\":\"0.nkdm3qdc4bc\",\"delegate\":\"0.nkdm3qdc4bc\",\"is_ghost\":false},\"root\":\"0.clmraaqp32\",\"id\":\"0.hmndv4gdp7o\"},{\"type\":\"container\",\"output\":5,\"inputs\":[],\"root\":\"0.clmraaqp32\",\"id\":\"0.8qfs9h3qv7\",\"ui\":{\"parent\":\"0.nkdm3qdc4bc\",\"is_ghost\":false}}],\"root\":\"0.clmraaqp32\",\"prev\":\"0.clmraaqp32\",\"id\":\"0.nkdm3qdc4bc\",\"ui\":{\"offset\":{\"x\":0,\"y\":0},\"is_toolbox_brick\":false,\"is_removing\":false,\"is_ghost\":false}},\"is_root\":true,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"set variable\",\"parent\":\"0.clmraaqp32\",\"delegate\":\"0.clmraaqp32\"},\"root\":\"0.clmraaqp32\",\"id\":\"0.ns8u23i6lp8\"},{\"type\":\"container\",\"is_static\":true,\"output\":1,\"inputs\":[{\"type\":\"atomic_input_string\",\"output\":1,\"is_static\":true,\"ui\":{\"value\":\"x\",\"parent\":\"0.oetvem23sbs\"},\"root\":\"0.clmraaqp32\",\"id\":\"0.go8j42jd3ms\"}],\"root\":\"0.clmraaqp32\",\"id\":\"0.oetvem23sbs\",\"ui\":{\"parent\":\"0.clmraaqp32\"}},{\"type\":\"atomic_text\",\"ui\":{\"value\":\"to\",\"parent\":\"0.clmraaqp32\",\"delegate\":\"0.clmraaqp32\"},\"root\":\"0.clmraaqp32\",\"id\":\"0.4mkto8sr57\"},{\"type\":\"container\",\"output\":5,\"inputs\":[],\"root\":\"0.clmraaqp32\",\"id\":\"0.l1feieck3ts\",\"ui\":{\"parent\":\"0.clmraaqp32\"}}],\"id\":\"0.clmraaqp32\",\"ui\":{\"offset\":{\"x\":455,\"y\":228},\"is_toolbox_brick\":false,\"is_removing\":false}},{\"type\":\"data_variable_get\",\"output\":5,\"is_root\":true,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"variable\",\"parent\":\"0.i35c2ir92b4\",\"delegate\":\"0.i35c2ir92b4\"},\"root\":\"0.i35c2ir92b4\",\"id\":\"0.8g3aa8obmao\"},{\"type\":\"container\",\"is_static\":true,\"output\":1,\"inputs\":[{\"type\":\"atomic_input_string\",\"output\":1,\"is_static\":true,\"ui\":{\"value\":\"x\",\"parent\":\"0.b52ijrru07s\"},\"root\":\"0.i35c2ir92b4\",\"id\":\"0.go51ikrvmgk\"}],\"root\":\"0.i35c2ir92b4\",\"id\":\"0.b52ijrru07s\",\"ui\":{\"parent\":\"0.i35c2ir92b4\"}}],\"id\":\"0.i35c2ir92b4\",\"ui\":{\"offset\":{\"x\":333,\"y\":445},\"is_toolbox_brick\":false,\"is_removing\":false}},{\"type\":\"data_variable_append\",\"next\":{\"id\":\"0.g5pj9r6btuk\",\"type\":\"control_if\",\"is_root\":false,\"next\":{\"type\":\"contorl_repeat_n_times\",\"is_root\":false,\"next\":null,\"parts\":[{\"type\":\"control_repeat_n_times#condition\",\"next\":null,\"is_static\":true,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"repeat\",\"parent\":\"0.otcggmthr44\",\"delegate\":\"0.otcggmthr44\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.8lom37oibng\"},{\"type\":\"container\",\"output\":2,\"inputs\":[],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.958vtpob1a\",\"ui\":{\"parent\":\"0.otcggmthr44\",\"is_ghost\":false}},{\"type\":\"atomic_text\",\"ui\":{\"value\":\"times\",\"parent\":\"0.otcggmthr44\",\"delegate\":\"0.otcggmthr44\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.an48bif831k\"}],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.otcggmthr44\",\"ui\":{\"parent\":\"0.183jrjhsjeg\",\"delegate\":\"0.183jrjhsjeg\",\"is_ghost\":false}},{\"type\":\"control_repeat_n_times#end_repeat\",\"is_static\":true,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"end repeat\",\"parent\":\"0.cct18eebvr\",\"delegate\":\"0.cct18eebvr\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.t9s2dgf0cc4\"}],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.cct18eebvr\",\"ui\":{\"parent\":\"0.183jrjhsjeg\",\"delegate\":\"0.183jrjhsjeg\",\"is_ghost\":false}}],\"root\":\"0.6mr0jo58gao\",\"prev\":\"0.g5pj9r6btuk\",\"id\":\"0.183jrjhsjeg\",\"ui\":{\"offset\":{\"x\":0,\"y\":0},\"is_toolbox_brick\":false,\"is_removing\":false,\"is_ghost\":false}},\"parts\":[{\"type\":\"control_if#if\",\"is_static\":true,\"next\":{\"id\":\"0.t1gd8832auc\",\"type\":\"control_if\",\"is_root\":false,\"next\":null,\"parts\":[{\"type\":\"control_if#if\",\"is_static\":true,\"next\":null,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"if\",\"parent\":\"0.9m7dhe5a24g\",\"delegate\":\"0.9m7dhe5a24g\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.equ5obf7b0c\"},{\"type\":\"container\",\"output\":3,\"inputs\":[],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.omq5hg8m81g\",\"ui\":{\"parent\":\"0.9m7dhe5a24g\",\"is_ghost\":false}},{\"type\":\"atomic_button\",\"is_static\":true,\"ui\":{\"className\":\"button_atomicButtonAdd_12dYc\",\"value\":\"control_if_btn_add\",\"parent\":\"0.9m7dhe5a24g\",\"delegate\":\"0.9m7dhe5a24g\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.kr7085h3rso\"},{\"type\":\"atomic_button\",\"is_static\":true,\"ui\":{\"className\":\"button_atomicButtonRemove_mZ4cd\",\"value\":\"control_if_btn_remove\",\"parent\":\"0.9m7dhe5a24g\",\"delegate\":\"0.9m7dhe5a24g\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.7umld423rms\"}],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.9m7dhe5a24g\",\"ui\":{\"parent\":\"0.t1gd8832auc\",\"delegate\":\"0.t1gd8832auc\",\"is_ghost\":false}},{\"type\":\"control_if#end_if\",\"is_static\":true,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"end if\",\"parent\":\"0.hrg44a0altk\",\"delegate\":\"0.hrg44a0altk\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.ghq9kvknl14\"}],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.hrg44a0altk\",\"ui\":{\"parent\":\"0.t1gd8832auc\",\"delegate\":\"0.t1gd8832auc\",\"is_ghost\":false}}],\"root\":\"0.6mr0jo58gao\",\"prev\":\"0.icfgmu5cnos\",\"ui\":{\"offset\":{\"x\":0,\"y\":0},\"is_ghost\":false}},\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"if\",\"parent\":\"0.icfgmu5cnos\",\"delegate\":\"0.icfgmu5cnos\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.feu4a3a2vl8\"},{\"type\":\"container\",\"output\":3,\"inputs\":[],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.8hilcgtk2n8\",\"ui\":{\"parent\":\"0.icfgmu5cnos\",\"is_ghost\":false}},{\"type\":\"atomic_button\",\"is_static\":true,\"ui\":{\"className\":\"button_atomicButtonAdd_12dYc\",\"value\":\"control_if_btn_add\",\"parent\":\"0.icfgmu5cnos\",\"delegate\":\"0.icfgmu5cnos\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.9mo00u860sg\"},{\"type\":\"atomic_button\",\"is_static\":true,\"ui\":{\"className\":\"button_atomicButtonRemove_mZ4cd\",\"value\":\"control_if_btn_remove\",\"parent\":\"0.icfgmu5cnos\",\"delegate\":\"0.icfgmu5cnos\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.d9gil2jj2ec\"}],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.icfgmu5cnos\",\"ui\":{\"parent\":\"0.g5pj9r6btuk\",\"delegate\":\"0.g5pj9r6btuk\",\"is_ghost\":false}},{\"type\":\"control_if#end_if\",\"is_static\":true,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"end if\",\"parent\":\"0.c19u71iptso\",\"delegate\":\"0.c19u71iptso\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.ee8h7bge3p4\"}],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.c19u71iptso\",\"ui\":{\"parent\":\"0.g5pj9r6btuk\",\"delegate\":\"0.g5pj9r6btuk\",\"is_ghost\":false}}],\"root\":\"0.6mr0jo58gao\",\"prev\":\"0.6mr0jo58gao\",\"ui\":{\"offset\":{\"x\":0,\"y\":0},\"is_toolbox_brick\":false,\"is_removing\":false,\"is_ghost\":false}},\"is_root\":true,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"append\",\"parent\":\"0.6mr0jo58gao\",\"delegate\":\"0.6mr0jo58gao\"},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.ik9d4amn8v8\"},{\"type\":\"container\",\"output\":5,\"inputs\":[{\"type\":\"data_empty_array\",\"output\":4,\"inputs\":[{\"type\":\"atomic_text\",\"ui\":{\"value\":\"empty array\",\"parent\":\"0.o7gpmr8mdp8\",\"delegate\":\"0.o7gpmr8mdp8\",\"is_ghost\":false},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.12e8bhrl62\"}],\"is_root\":false,\"root\":\"0.6mr0jo58gao\",\"id\":\"0.o7gpmr8mdp8\",\"ui\":{\"parent\":\"0.9ogggesl3ok\",\"offset\":{\"x\":0,\"y\":0},\"is_toolbox_brick\":false,\"is_removing\":false,\"is_ghost\":false}}],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.9ogggesl3ok\",\"ui\":{\"parent\":\"0.6mr0jo58gao\"}},{\"type\":\"atomic_text\",\"ui\":{\"value\":\"to\",\"parent\":\"0.6mr0jo58gao\",\"delegate\":\"0.6mr0jo58gao\"},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.o84gf93qaj4\"},{\"type\":\"container\",\"is_static\":true,\"output\":1,\"inputs\":[{\"type\":\"atomic_input_string\",\"output\":1,\"is_static\":true,\"ui\":{\"value\":\"x\",\"parent\":\"0.i1oaes3el78\"},\"root\":\"0.6mr0jo58gao\",\"id\":\"0.3kbb8g9mjeo\"}],\"root\":\"0.6mr0jo58gao\",\"id\":\"0.i1oaes3el78\",\"ui\":{\"parent\":\"0.6mr0jo58gao\"}}],\"id\":\"0.6mr0jo58gao\",\"ui\":{\"offset\":{\"x\":583,\"y\":411},\"is_toolbox_brick\":false,\"is_removing\":false}}]"
))
const root_bricks = load();
console.log(toolbox);
console.log(root_bricks);
createRoot(document.getElementById("main")).render(
  <Workspace
    id="a"
    root_bricks={root_bricks}
    atomic_button_fns={atomic_button_fns}
    atomic_dropdown_menu={atomic_dropdown_menu}
    toolbox={toolbox}
    workspace_on_change={(bricks: Brick[]) => save(bricks)}
  />
);